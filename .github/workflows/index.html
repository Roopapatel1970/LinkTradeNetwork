<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sign In ‚Ä¢ LinkTradeNetwork</title>
<style>
  :root{
    --bg:#1f2937; --panel:#111827; --ink:#0f172a;
    --brand:#6366f1; --brand2:#4f46e5; --ok:#16a34a; --err:#ef4444;
    --card:#ffffff; --muted:#6b7280; --line:#e5e7eb; --chip:#2b3342;
  }
  *{box-sizing:border-box}
  body{margin:0;background:#2d3748;color:#111827;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Inter,Roboto,Arial}
  /* Top banner (keep) */
  header{background:#64748b;padding:22px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
  .brand{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:14px;text-decoration:none;color:#000}
  .brand .logo{font-size:34px}
  .brand b{font-size:36px;letter-spacing:.5px}

  /* Page layout */
  .wrap{max-width:980px;margin:42px auto;padding:0 16px}
  .chips{
    background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);
    border-radius:14px;padding:12px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center
  }
  .chip{
    background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.2);
    color:#fff;padding:.55rem .9rem;border-radius:9px;font-weight:700;font-size:.85rem
  }
  .chip:hover{background:rgba(99,102,241,.25);border-color:#6366f1;transform:translateY(-2px);transition:.2s}

  .grid{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:18px}
  @media(max-width:900px){ .grid{grid-template-columns:1fr} }

  /* Card */
  .card{
    background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.25)
  }
  .card .pad{padding:26px}

  /* Tight sign-in */
  .h{margin:0 0 6px 0;font-size:28px}
  .sub{color:var(--muted);margin-bottom:18px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:480px){ .row{grid-template-columns:1fr} }
  label{display:block;font-weight:600;margin:10px 0 6px 0}
  input{
    width:100%;border:2px solid var(--line);border-radius:10px;padding:.75rem .9rem;font-size:16px;
    transition:box-shadow .15s,border-color .15s
  }
  input:focus{outline:0;border-color:var(--brand);box-shadow:0 0 0 3px rgba(99,102,241,.15)}
  .agree{display:flex;align-items:flex-start;gap:10px;margin-top:8px}
  .agree input{width:18px;height:18px;margin-top:2px}
  .agree span{color:var(--muted);font-size:.95rem}
  .agree a{color:var(--brand2);text-decoration:none}
  .agree a:hover{text-decoration:underline}

  .btn{
    width:100%;margin-top:14px;background:var(--brand);color:#fff;border:none;border-radius:10px;
    padding:.9rem 1rem;font-weight:800;letter-spacing:.2px;cursor:pointer;transition:transform .12s,box-shadow .12s,background .12s
  }
  .btn:hover{background:var(--brand2);transform:translateY(-1px);box-shadow:0 8px 22px rgba(99,102,241,.35)}
  .btn[disabled]{background:#9ca3af;cursor:not-allowed;transform:none;box-shadow:none}

  .msg{display:none;margin-top:10px;border-radius:10px;padding:.8rem 1rem;font-weight:600;text-align:center}
  .msg.ok{display:block;background:#d1fae5;color:#065f46;border:1px solid #10b981}
  .msg.err{display:block;background:#fee2e2;color:#b91c1c;border:1px solid #ef4444}

  /* Side block */
  .side{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.18);border-radius:16px;padding:18px;color:#fff}
  .side h3{margin:0 0 10px 0}
  .bul{margin:0;padding-left:18px;line-height:1.7}
  .bul li{margin:0 0 6px 0}
  .muted{color:#b6c2d2;font-size:.95rem}
  .center{display:flex;justify-content:center;margin:14px 0 0}
  .link{color:#fff;text-decoration:underline}
</style>
</head>
<body>

<header>
  <a class="brand" href="landingpage.html">
    <span class="logo">üåç</span><b>LinkTradeNetwork</b>
  </a>
</header>

<main class="wrap">
  <!-- trades ribbon -->
  <div class="chips">
    <span class="chip">Electricians</span>
    <span class="chip">Low Voltage</span>
    <span class="chip">Physical Security</span>
    <span class="chip">HVAC</span>
    <span class="chip">Plumbing</span>
    <span class="chip">General Contractors</span>
  </div>

  <div class="grid">
    <!-- left: sign-in card -->
    <section class="card">
      <div class="pad">
        <h1 class="h">Sign In</h1>
        <div class="sub">Access your LinkTradeNetwork account</div>

        <form id="form">
          <div class="row">
            <div>
              <label for="first">First name</label>
              <input id="first" autocomplete="given-name" required />
            </div>
            <div>
              <label for="last">Last name</label>
              <input id="last" autocomplete="family-name" required />
            </div>
          </div>

          <label for="email">Email address</label>
          <input id="email" type="email" autocomplete="email" required />

          <div class="agree">
            <input id="terms" type="checkbox" required />
            <span>I agree to the <a href="terms.html" target="_blank">Terms & Conditions</a>.</span>
          </div>

          <button id="submit" class="btn" type="submit">Sign In</button>
        </form>

        <div id="msg" class="msg"></div>

        <div class="center muted">
          Don‚Äôt have an account?&nbsp;<a class="link" href="signup.html">Sign up</a>
        </div>
      </div>
    </section>

    <!-- right: context/help -->
    <aside class="side">
      <h3>Why join?</h3>
      <ul class="bul">
        <li>Showcase your trade profile</li>
        <li>Connect & message peers</li>
        <li>Find jobs and crews fast</li>
      </ul>
      <p class="muted">You can update your profile any time after sign-in.</p>
    </aside>
  </div>
</main>

<script>
  // Use your live Apps Script endpoint here (same one you use elsewhere)
  const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyGdnl2QSB36asGlyX9voB0iZaQzamojty5HHzvYuBhWmhfsabmf3jsCcR2Lm-udsnl/exec';

  const $ = (id) => document.getElementById(id);
  const form = $('form');
  const msg  = $('msg');
  const btn  = $('submit');

  function show(type, text){
    msg.className = 'msg ' + type;
    msg.textContent = text;
  }

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    if(!$('terms').checked){ show('err','Please accept the Terms to continue.'); return; }

    const first = $('first').value.trim();
    const last  = $('last').value.trim();
    const email = $('email').value.trim().toLowerCase();

    btn.disabled = true; btn.textContent = 'Signing in‚Ä¶'; show('', '');

    const userData = { name:`${first} ${last}`.trim(), email, signedInAt:new Date().toISOString() };

    try{
      // no headers -> no CORS preflight
      await fetch(GOOGLE_SCRIPT_URL, {
        method:'POST',
        body: JSON.stringify({
          action:'addPerson',
          person:{ firstName:first, lastName:last, email }
        })
      });

      localStorage.setItem('linktradeUser', JSON.stringify(userData));
      localStorage.setItem('userProfile:v1', JSON.stringify({
        firstName:first, lastName:last, email, headline:'', photo:''
      }));

      show('ok','Welcome! Redirecting‚Ä¶');
      setTimeout(()=> location.href='front.html', 500);
    }catch(err){
      console.error(err);
      show('err','Sign in failed. Please try again.');
      btn.disabled=false; btn.textContent='Sign In';
    }
  });

  // If user already signed in, greet them
  window.addEventListener('load', ()=>{
    try{
      const cached = JSON.parse(localStorage.getItem('linktradeUser')||'null');
      if(cached?.name){ show('ok', `Welcome back, ${cached.name}!`); }
    }catch{}
  });
</script>
</body>
</html>
