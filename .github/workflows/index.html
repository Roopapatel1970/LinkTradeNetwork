<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Join â€¢ LinkTradeNetwork</title>

<style>
  :root{
    --bg:#0b0f17;        /* page background */
    --card:#0f1726;      /* panel */
    --ink:#eaf0ff;       /* text */
    --muted:#9fb0cc;     /* secondary text */
    --line:#223050;      /* borders */
    --brand:#ea6a00;     /* button */
    --brand-600:#c35700; /* button hover */
    --ok:#3cd682;
    --err:#ff6b6b;
  }

  /* Base */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Inter,Roboto,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* Centered wrap */
  .wrap{
    min-height:100dvh;
    display:grid; place-items:center;
    padding:24px;
  }

  /* Card */
  .card{
    width:100%; max-width:720px;             /* wider than before so it fits on one page */
    background:var(--card);
    border:1px solid var(--line);
    border-radius:20px;
    box-shadow:0 18px 60px rgba(0,0,0,.45);
  }
  .pad{padding:28px 28px}

  /* Headings */
  h1{margin:0 0 6px; font-size:28px; line-height:1.15; letter-spacing:.2px}
  .sub{margin:0 0 18px; color:var(--muted); font-size:15px}

  /* Grid */
  .row{display:grid; gap:12px}
  .row2{grid-template-columns:1fr 1fr}
  @media (max-width:640px){ .row2{grid-template-columns:1fr} }

  /* Labels + inputs */
  label{display:block; font-size:13px; color:var(--muted); margin:2px 0 6px}
  .field{display:flex; flex-direction:column}
  input, select{
    appearance:none;
    width:100%; height:48px;
    background:#0b1322; color:var(--ink);
    border:1.5px solid var(--line);
    border-radius:14px;
    padding:12px 14px;
    font-size:15px;
    transition:border .15s, box-shadow .15s;
  }
  input::placeholder{color:#6b7b95}
  input:focus, select:focus{
    outline:none;
    border-color:#355aa3;
    box-shadow:0 0 0 3px rgba(53,90,163,.25);
  }
  /* Select arrow */
  select{background-image: linear-gradient(45deg,transparent 50%,#8aa0c3 50%),
                          linear-gradient(135deg,#8aa0c3 50%,transparent 50%),
                          linear-gradient(to right,#22304a,#22304a);
         background-position: calc(100% - 18px) 18px, calc(100% - 12px) 18px, calc(100% - 40px) center;
         background-size:6px 6px, 6px 6px, 1px 28px; background-repeat:no-repeat; padding-right:48px }

  /* Checkbox line (smaller, single line on desktop) */
  .agree{
    display:flex; align-items:center; gap:10px;
    margin-top:2px; color:var(--muted); font-size:14px; line-height:1.3;
  }
  .agree input{width:18px; height:18px; accent-color:#4068c9}

  /* Button */
  .btn{
    width:100%; height:54px;
    margin-top:14px;
    background:var(--brand); color:#fff;
    border:0; border-radius:14px;
    font-weight:800; font-size:16px;
    cursor:pointer; transition:transform .05s ease, background .15s ease;
  }
  .btn:hover{background:var(--brand-600)}
  .btn:active{transform:translateY(1px)}
  .btn[disabled]{opacity:.6; cursor:not-allowed}

  /* Messages */
  .msg{margin-top:10px; font-size:14px}
  .msg.ok{color:var(--ok)} .msg.err{color:var(--err)}

  /* OTP box */
  .otp{
    margin-top:18px;
    padding:16px;
    border:1px dashed #31425f;
    border-radius:16px;
    background:#0b1426;
    display:none;
  }
  .otp .inputs{display:flex; gap:10px; margin:12px 0}
  .otp .inputs input{
    width:54px; height:58px; text-align:center; font-size:22px;
    border-radius:12px; border:1.5px solid var(--line); background:#0b1322; color:var(--ink);
  }

  /* Footer hint */
  .hint{margin-top:8px; color:#7e90ad; font-size:13px; text-align:center}

  .hide{display:none !important}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="pad">
        <h1>Join LinkTradeNetwork</h1>
        <p class="sub">Quick, one-time email verification for new accounts.</p>

        <!-- STEP: JOIN -->
        <div id="step-join" class="row">
          <div class="row row2">
            <div class="field">
              <label for="name">Name</label>
              <input id="name" type="text" placeholder="Your full name" autocomplete="name">
            </div>
            <div class="field">
              <label for="email">Email</label>
              <input id="email" type="email" placeholder="you@example.com" autocomplete="email">
            </div>
          </div>

          <div class="row row2">
            <div class="field">
              <label for="phone">Phone (optional)</label>
              <input id="phone" type="tel" placeholder="555-123-4567" autocomplete="tel">
            </div>
            <div class="field">
              <label for="userType">User Type</label>
              <select id="userType">
                <option value="">Selectâ€¦</option>
                <option>Worker</option>
                <option>Business</option>
              </select>
            </div>
          </div>

          <div class="field">
            <label for="trade">Trade / Industry</label>
            <input id="trade" type="text" placeholder="Electrician, Low Voltage, HVAC, etc.">
          </div>

          <label class="agree">
            <input id="consent" type="checkbox">
            <span>I agree to the Terms & understand I may receive important account emails.</span>
          </label>

          <button id="joinBtn" class="btn" type="button">Join</button>
          <div id="joinMsg" class="msg"></div>
        </div>

        <!-- STEP: OTP -->
        <div id="step-otp" class="otp">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
            <div>Enter the 6-digit code sent to <b id="otpEmail"></b>. Expires in 10 minutes.</div>
            <button id="resendBtn" class="btn" type="button" style="width:auto;height:42px;padding:0 14px;background:#334155">Resend</button>
          </div>
          <div class="inputs" id="otpInputs">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
            <input maxlength="1" inputmode="numeric" pattern="[0-9]*">
          </div>
          <button id="verifyBtn" class="btn" type="button">Verify</button>
          <div id="otpMsg" class="msg"></div>
        </div>

        <!-- STEP: DONE -->
        <div id="step-done" class="hide">
          <div class="msg ok"><b>Success!</b> Youâ€™re in.</div>
          <div class="hint">Youâ€™ll skip the code next time with this email.</div>
        </div>
      </div>
    </div>
  </div>

<script>
(function(){
  // ðŸ”— Your current Apps Script Web App URL
  const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzXTtg4nPlR6xhzn56_0tFjc4NfXAJEjuzIKlJR1PP_90K6yfsMKgG_xnTMUlflf8psfg/exec';

  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  const joinBtn = $('#joinBtn'), joinMsg = $('#joinMsg');
  const stepJoin = $('#step-join'), stepOtp = $('#step-otp'), stepDone = $('#step-done');
  const otpEmail = $('#otpEmail'), otpMsg = $('#otpMsg');
  const inputs = $$('#otpInputs input');

  let currentEmail = '', currentName = '';

  // OTP input behavior
  inputs.forEach((inp, i) => {
    inp.addEventListener('input', () => {
      inp.value = inp.value.replace(/\D/g,'').slice(0,1);
      if (inp.value && i < inputs.length - 1) inputs[i+1].focus();
    });
    inp.addEventListener('keydown', (e) => {
      if (e.key === 'Backspace' && !inp.value && i>0) inputs[i-1].focus();
    });
  });
  function codeValue(){ return inputs.map(i=>i.value).join(''); }
  function clearCode(){ inputs.forEach(i=>i.value=''); inputs[0].focus(); }
  function setMsg(el, text, cls=''){ el.textContent = text || ''; el.className = 'msg ' + cls; }

  // JOIN
  joinBtn.addEventListener('click', async () => {
    const name = $('#name').value.trim();
    const email = $('#email').value.trim().toLowerCase();
    const phone = $('#phone').value.trim();
    const userType = $('#userType').value.trim();
    const trade = $('#trade').value.trim();
    const consent = $('#consent').checked;

    if (!name || !email){ setMsg(joinMsg,'Name and email are required','err'); return; }
    if (!consent){ setMsg(joinMsg,'Please agree to the Terms to continue.','err'); return; }

    joinBtn.disabled = true; setMsg(joinMsg,'Workingâ€¦','');

    try{
      const res = await fetch(WEB_APP_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({
          action:'signup',
          name, email, phone, userType, trade,
          consent, userAgent: navigator.userAgent
        })
      });
      const data = await res.json();
      if (data.success === false){ setMsg(joinMsg, data.error || 'Error','err'); return; }

      if (data.verified && !data.requiresOtp){
        stepJoin.classList.add('hide'); stepDone.classList.remove('hide'); setMsg(joinMsg,'',''); return;
      }
      currentEmail = email; currentName = name;
      otpEmail.textContent = email;
      stepJoin.classList.add('hide'); stepOtp.style.display = 'block'; clearCode();
      setMsg(joinMsg,'','');

    }catch(err){
      setMsg(joinMsg,'Network error.','err');
    }finally{
      joinBtn.disabled = false;
    }
  });

  // VERIFY
  $('#verifyBtn').addEventListener('click', async () => {
    const code = codeValue();
    if (code.length !== 6){ setMsg(otpMsg,'Enter the 6-digit code.','err'); return; }
    try{
      const res = await fetch(WEB_APP_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ action:'verify', email: currentEmail, code })
      });
      const data = await res.json();
      if (!data.success){ setMsg(otpMsg, data.error || 'Error','err'); return; }
      if (data.verified){
        stepOtp.style.display='none'; stepDone.classList.remove('hide');
      }else{
        setMsg(otpMsg,'Unexpected response.','err');
      }
    }catch(err){
      setMsg(otpMsg,'Network error.','err');
    }
  });

  // RESEND
  $('#resendBtn').addEventListener('click', async () => {
    try{
      const res = await fetch(WEB_APP_URL, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ action:'resend', email: currentEmail, name: currentName || 'there' })
      });
      const data = await res.json();
      if (!data.success){ setMsg(otpMsg, data.error || 'Error','err'); return; }
      setMsg(otpMsg,'A new code has been sent.','ok'); clearCode();
    }catch(err){
      setMsg(otpMsg,'Network error.','err');
    }
  });
})();
</script>
</body>
</html>




