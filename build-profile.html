<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Build Profile ‚Äì LinkTradeNetwork</title>
<style>
  :root{--bg:#f3f4f6;--ink:#0f172a;--muted:#64748b;--line:#e5e7eb;--card:#fff;--brand:#0a66c2;--brand2:#004182}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Inter,Roboto,Arial}
  a{color:inherit;text-decoration:none}

  header{background:#64748b;color:#fff;box-shadow:0 2px 10px rgba(0,0,0,.12)}
  .bar{max-width:1100px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between}
  .brand{display:flex;gap:10px;align-items:center}
  .brand b{font-size:18px}
  .nav a{color:#fff;opacity:.95;margin-left:12px}
  .nav a:hover{opacity:.85}

  .wrap{max-width:1100px;margin:18px auto;padding:0 14px;display:grid;grid-template-columns:1fr 360px;gap:18px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;box-shadow:0 1px 2px rgba(0,0,0,.05)}
  .pad{padding:14px}

  h1{margin:0 0 8px;font-size:22px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .btn{background:var(--brand);color:#fff;border:none;border-radius:10px;padding:.6rem 1rem;font-weight:800;cursor:pointer}
  .btn:hover{background:var(--brand2)}
  .btn.gray{background:#6b7280}.btn.gray:hover{background:#4b5563}
  .btn.ghost{background:#fff;border:1px solid #d1d5db;color:#0f172a}
  .muted{color:var(--muted);font-size:13px}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .row{display:grid;gap:6px;margin-bottom:12px}
  label{font-weight:700;font-size:13px;color:#334155}
  input,select,textarea{border:1px solid #d1d5db;border-radius:10px;padding:.6rem .75rem;font-size:15px}
  textarea{min-height:110px;resize:vertical}

  .avatar{display:flex;align-items:center;gap:12px}
  .ph{width:96px;height:96px;border-radius:50%;background:#eef2ff;border:1px solid #dbeafe;
      display:flex;align-items:center;justify-content:center;overflow:hidden;font-size:32px}
  .ph img{width:100%;height:100%;object-fit:cover}

  .chip{display:inline-block;background:#e0e7ff;border:1px solid #c7d2fe;color:#1e3a8a;
        border-radius:999px;padding:6px 10px;font-weight:700;font-size:12px;margin:4px 6px 0 0}
  .chip .x{margin-left:6px;cursor:pointer}

  .exp{border:1px solid #e5e7eb;border-radius:12px;padding:10px;margin-bottom:10px}
  .exp .actions{display:flex;gap:8px;margin-top:8px}

  .ok{display:none;margin-bottom:10px;background:#d1fae5;color:#065f46;border:1px solid #10b981;
      border-radius:10px;padding:.55rem .8rem;font-weight:800}
  .ok.show{display:block}

  @media(max-width:980px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>
<header>
  <div class="bar">
    <a class="brand" href="front.html" aria-label="Home"><span style="font-size:22px">üåç</span><b>LinkTradeNetwork</b></a>
    <div class="nav">
      <a href="front.html">Home</a>
      <a href="network.html">Network</a>
      <a href="messaging.html">Messaging</a>
      <a href="my-profile.html">My Profile</a>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- LEFT: form -->
  <section class="card pad">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
      <h1>Build Your Profile</h1>
      <div class="toolbar">
        <button class="btn gray" id="loadLocal" type="button" title="Load last saved locally">Load</button>
        <button class="btn ghost" id="clear" type="button">Clear</button>
        <button class="btn" id="save" type="button">Save</button>
        <button class="btn" id="saveView" type="button" title="Save then view">Save & View</button>
        <!-- NEW: Load from Google Sheet (read-only) -->
        <button class="btn ghost" id="loadSheet" type="button" title="Import profile from Google Sheet">Load from Google Sheet</button>
      </div>
    </div>
    <div id="ok" class="ok">Saved locally ‚úì</div>

    <!-- Photo -->
    <div class="row">
      <label>Photo</label>
      <div class="avatar">
        <div class="ph" id="ph">üë§</div>
        <input type="file" id="photo" accept="image/*" />
      </div>
      <div class="muted">Your photo and profile save in your browser only.</div>
    </div>

    <!-- Name / Headline -->
    <div class="grid2">
      <div class="row"><label>First name</label><input id="firstName" placeholder="e.g., Jordan" /></div>
      <div class="row"><label>Last name</label><input id="lastName" placeholder="e.g., Rivera" /></div>
    </div>
    <div class="row"><label>Headline</label><input id="headline" placeholder="e.g., Fiber Tech ‚Ä¢ Low Voltage ‚Ä¢ Access Control" /></div>

    <!-- Trade / Availability -->
    <div class="grid2">
      <div class="row"><label>Trade</label><input id="trade" placeholder="e.g., Fiber Optic Technician" /></div>
      <div class="row">
        <label>Availability</label>
        <select id="availability">
          <option>Employed</option>
          <option>Actively Looking</option>
          <option>Open to Offers</option>
          <option>Not Available</option>
        </select>
      </div>
    </div>

    <!-- Location / Contact -->
    <div class="grid2">
      <div class="row"><label>Location</label><input id="location" placeholder="City, State" /></div>
      <div class="row"><label>Email</label><input id="email" type="email" placeholder="you@example.com" /></div>
    </div>
    <div class="row"><label>Phone</label><input id="phone" placeholder="(555) 555-5555" /></div>

    <!-- Summary -->
    <div class="row"><label>About / Summary</label><textarea id="summary" placeholder="Tell people about your experience, specialties, and goals."></textarea></div>

    <!-- Experience -->
    <div class="row">
      <label>Experience</label>
      <div id="expList"></div>
      <button class="btn ghost" id="addExp" type="button">+ Add Experience</button>
    </div>

    <!-- Skills -->
    <div class="row">
      <label>Skills (press Enter to add)</label>
      <input id="skillInput" placeholder="e.g., Fiber splicing" />
      <div id="skills"></div>
    </div>

    <!-- Certifications -->
    <div class="row"><label>Certifications & Licenses</label><textarea id="certs" placeholder="List certs, license numbers (optional)"></textarea></div>
  </section>

  <!-- RIGHT: tips -->
  <aside class="card pad">
    <h2 style="margin:0 0 10px;font-size:18px">Tips</h2>
    <div class="muted">Use <b>Save</b> to keep changes in your browser. Use <b>Save & View</b> to jump to your profile page.</div>
    <div class="muted" style="margin-top:8px">Photo preview appears instantly. You can change it anytime and save again.</div>
    <div class="muted" style="margin-top:8px">Skills become chips with Enter. Click the √ó on a chip to remove it.</div>
    <div class="muted" style="margin-top:8px"><b>Load from Google Sheet</b> is read-only and will not overwrite your cloud sheet. It just imports here.</div>
  </aside>
</main>

<script>
/* ====== CONFIG: your Apps Script endpoint (read-only import) ====== */
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwvpweco_FFHNvx-XT4JDvULZ0ax9fVG34gJGbk_3zZz6mUYuvUwJo8ayR0ysqrIDyw/exec";
/* If your script needs a query param, e.g.
   const SHEET_URL = "https://.../exec?action=getProfile";
*/

/* ===== storage keys ===== */
const KEY='userProfile:v1';
const LEGACY='userProfile'; // backward-compat
const $=id=>document.getElementById(id);

/* elements */
const el={
  ok:$('ok'),
  ph:$('ph'), photo:$('photo'),
  firstName:$('firstName'), lastName:$('lastName'), headline:$('headline'),
  trade:$('trade'), availability:$('availability'),
  location:$('location'), email:$('email'), phone:$('phone'),
  summary:$('summary'), certs:$('certs'),
  expList:$('expList'), addExp:$('addExp'),
  skillInput:$('skillInput'), skills:$('skills'),
  save:$('save'), saveView:$('saveView'), clear:$('clear'),
  loadLocal:$('loadLocal'), loadSheet:$('loadSheet')
};

let photoData='', skillSet=[], experiences=[];

/* storage helpers */
function saveLocal(obj){
  const json=JSON.stringify(obj);
  localStorage.setItem(KEY,json);
  localStorage.setItem(LEGACY,json);
  el.ok.textContent='Saved locally ‚úì';
  el.ok.classList.add('show'); setTimeout(()=>el.ok.classList.remove('show'),1200);
}
function loadLocal(){
  const raw=localStorage.getItem(KEY)||localStorage.getItem(LEGACY);
  try{ return raw?JSON.parse(raw):null }catch{ return null }
}

/* always blank to start */
function clearForm(){
  photoData=''; el.ph.innerHTML='üë§';
  ['firstName','lastName','headline','trade','location','email','phone','summary','certs'].forEach(k=>el[k].value='');
  el.availability.value='Employed';
  skillSet=[]; renderSkills();
  experiences=[]; renderExperiences();
}

/* skills */
function chip(text,i){ return `<span class="chip">${text}<span class="x" data-i="${i}" title="Remove">√ó</span></span>`; }
function renderSkills(){
  el.skills.innerHTML = skillSet.map((s,i)=>chip(s,i)).join('');
  el.skills.querySelectorAll('[data-i]').forEach(x=> x.onclick = ()=>{ const ii=+x.dataset.i; skillSet.splice(ii,1); renderSkills(); });
}

/* experience */
function expCard(exp,i){
  return `
    <div class="exp" data-i="${i}">
      <div class="grid2">
        <div class="row"><label>Job Title</label><input data-f="jobTitle" value="${exp.jobTitle||''}" placeholder="Fiber Technician"></div>
        <div class="row"><label>Company</label><input data-f="company" value="${exp.company||''}" placeholder="LinkTN Installations"></div>
      </div>
      <div class="grid2">
        <div class="row"><label>Start</label><input data-f="startDate" value="${exp.startDate||''}" placeholder="Jan 2023"></div>
        <div class="row"><label>End</label><input data-f="endDate" value="${exp.endDate||''}" placeholder="Present"></div>
      </div>
      <div class="row"><label>Description</label><textarea data-f="description" placeholder="Key work, tools, outcomes">${exp.description||''}</textarea></div>
      <div class="actions">
        <button class="btn gray" data-up="${i}" type="button">‚Üë</button>
        <button class="btn gray" data-down="${i}" type="button">‚Üì</button>
        <button class="btn" data-del="${i}" type="button">Delete</button>
      </div>
    </div>
  `;
}
function renderExperiences(){
  el.expList.innerHTML = experiences.map(expCard).join('');
  el.expList.querySelectorAll('.exp').forEach(card=>{
    const i=+card.dataset.i;
    card.querySelectorAll('[data-f]').forEach(inp=>{
      inp.addEventListener('input',()=>{ experiences[i][inp.dataset.f]=inp.value; });
    });
  });
  el.expList.querySelectorAll('[data-del]').forEach(b=> b.onclick=()=>{ const i=+b.dataset.del; experiences.splice(i,1); renderExperiences(); });
  el.expList.querySelectorAll('[data-up]').forEach(b=> b.onclick=()=>{ const i=+b.dataset.up; if(i>0){ [experiences[i-1],experiences[i]]=[experiences[i],experiences[i-1]]; renderExperiences(); } });
  el.expList.querySelectorAll('[data-down]').forEach(b=> b.onclick=()=>{ const i=+b.dataset.down; if(i<experiences.length-1){ [experiences[i+1],experiences[i]]=[experiences[i],experiences[i+1]]; renderExperiences(); } });
}

/* events */
el.photo.onchange = e=>{
  const f=e.target.files?.[0]; if(!f) return;
  const r=new FileReader();
  r.onload = ()=>{ photoData=r.result; el.ph.innerHTML=`<img src="${photoData}" alt="photo">`; };
  r.readAsDataURL(f);
};
el.skillInput.addEventListener('keydown', e=>{
  if(e.key==='Enter'){
    e.preventDefault();
    const v=el.skillInput.value.trim();
    if(v){ skillSet.push(v); el.skillInput.value=''; renderSkills(); }
  }
});
el.addExp.onclick = ()=>{ experiences.push({jobTitle:'',company:'',startDate:'',endDate:'',description:''}); renderExperiences(); };

el.clear.onclick = ()=>{ if(confirm('Clear all fields?')) clearForm(); };

el.loadLocal.onclick = ()=>{
  const p = loadLocal();
  if(!p){ alert('No saved profile found locally.'); return; }
  applyProfile(p, {showToast:true, toast:'Loaded ‚úì'});
};

/* build object from form */
function buildProfile(){
  return {
    firstName:el.firstName.value.trim(),
    lastName:el.lastName.value.trim(),
    headline:el.headline.value.trim(),
    trade:el.trade.value.trim(),
    availability:el.availability.value,
    location:el.location.value.trim(),
    email:el.email.value.trim(),
    phone:el.phone.value.trim(),
    photo:photoData||'',
    summary:el.summary.value.trim(),
    skills:skillSet.join(', '),
    certifications:el.certs.value.trim(),
    experiences:experiences
  };
}

el.save.onclick = ()=>{ saveLocal(buildProfile()); };
el.saveView.onclick = ()=>{ saveLocal(buildProfile()); location.href='my-profile.html'; };

/* ===== NEW: Load from Google Sheet (read-only) ===== */
async function loadFromSheet(){
  try{
    // GET JSON from Apps Script; adjust if you use query params (see SHEET_URL above)
    const res = await fetch(SHEET_URL, { method:'GET' });
    if(!res.ok) throw new Error('Sheet server returned '+res.status);
    const p = await res.json();

    // Normalize: allow either array of experiences or CSV skills
    if (typeof p.skills === 'string') {
      // keep CSV; we split later in applyProfile
    }
    if (!Array.isArray(p.experiences)) {
      p.experiences = [];
    }

    applyProfile(p, {showToast:true, toast:'Imported from Google Sheet ‚úì'});
  }catch(err){
    console.error(err);
    alert('Could not load from Google Sheet. Make sure your Apps Script returns JSON and allows CORS.\n\n' + err.message);
  }
}

function applyProfile(p, opts={}){
  photoData = p.photo || '';
  el.ph.innerHTML = photoData ? `<img src="${photoData}" alt="photo">` : 'üë§';

  el.firstName.value = p.firstName || '';
  el.lastName.value  = p.lastName  || '';
  el.headline.value  = p.headline  || '';
  el.trade.value     = p.trade     || '';
  el.availability.value = p.availability || 'Employed';
  el.location.value  = p.location  || '';
  el.email.value     = p.email     || '';
  el.phone.value     = p.phone     || '';
  el.summary.value   = p.summary   || '';
  el.certs.value     = p.certifications || '';

  skillSet = Array.isArray(p.skills) ? p.skills : String(p.skills||'').split(',').map(s=>s.trim()).filter(Boolean);
  renderSkills();

  experiences = Array.isArray(p.experiences) ? p.experiences : [];
  renderExperiences();

  if(opts.showToast){
    el.ok.textContent = opts.toast || 'Loaded ‚úì';
    el.ok.classList.add('show');
    setTimeout(()=>{ el.ok.classList.remove('show'); el.ok.textContent='Saved locally ‚úì'; }, 1200);
  }
}

el.loadSheet.onclick = loadFromSheet;

/* init: always blank */
clearForm();
</script>
</body>
</html>



         




