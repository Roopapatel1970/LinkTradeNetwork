<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Profile ‚Äì LinkTradeNetwork</title>
<style>
  :root{
    --ink:#1f2937; --muted:#6b7280; --line:#e5e7eb; --bg:#f3f4f6; --card:#fff;
    --brand:#0a66c2; --brand-2:#004182; --chip:#eef2ff;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Inter,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink)}
  a{color:inherit}
  /* Top bar */
  header{background:#fff;border-bottom:1px solid var(--line)}
  .topbar{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:12px;padding:10px 16px}
  .brand{display:flex;align-items:center;gap:8px;text-decoration:none}
  .brand-badge{width:34px;height:34px;display:grid;place-items:center;border-radius:8px;background:#e6f2fb;color:#0a66c2;font-weight:800}
  .brand-text{font-weight:800}
  .topbar-actions{margin-left:auto;display:flex;gap:8px}
  .btn{appearance:none;border:none;background:var(--brand);color:#fff;border-radius:999px;font-weight:700;padding:8px 14px;cursor:pointer}
  .btn.secondary{background:#e5e7eb;color:#111;border:1px solid #d1d5db}
  .btn:hover{background:var(--brand-2)}
  .btn.secondary:hover{background:#dbe1e7}
  /* Banner + card */
  .wrap{max-width:1100px;margin:0 auto;padding:0 16px}
  .banner{height:180px;border-radius:0 0 12px 12px;background:linear-gradient(135deg,#0a66c2 0%,#2563eb 45%,#60a5fa 100%);position:relative}
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
  .profile-card{margin-top:-64px;padding:16px}
  .profile-row{display:flex;gap:16px}
  .avatar{width:128px;height:128px;border-radius:50%;border:4px solid #fff;background:#eef2ff;display:flex;align-items:center;justify-content:center;font-size:56px;color:#9aa2b1;overflow:hidden;flex-shrink:0}
  .avatar img{width:100%;height:100%;object-fit:cover}
  .flex-1{flex:1}
  .headline{font-size:26px;font-weight:800;margin:8px 0 4px}
  .sub{color:var(--muted)}
  .meta{display:flex;gap:14px;flex-wrap:wrap;color:#4b5563;margin-top:6px}
  .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  .chip{background:#edf2ff;border:1px solid #dbe4ff;color:#1e3a8a;padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px}
  .actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
  .nav{margin-top:14px;border-top:1px solid var(--line);display:flex;gap:8px;flex-wrap:wrap}
  .tab{padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:700;color:#334155}
  .tab.active{background:#e8f3ff;color:#0a66c2}
  /* Sections */
  .grid{display:grid;grid-template-columns:minmax(0,2fr) minmax(280px,1fr);gap:16px;margin-top:16px}
  .section{padding:16px}
  .section h2{font-size:18px;margin:0 0 8px}
  .about{white-space:pre-wrap;line-height:1.7;color:#374151}
  .exp-item{padding:12px 0;border-bottom:1px solid var(--line)}
  .exp-item:last-child{border-bottom:none}
  .exp-title{font-weight:800}
  .exp-meta{color:#6b7280;font-size:14px;margin:4px 0}
  .exp-desc{white-space:pre-wrap;color:#374151;margin-top:6px}
  .skills{display:flex;flex-wrap:wrap;gap:8px}
  .skill{background:var(--chip);border:1px solid #dfe3f6;padding:6px 12px;border-radius:999px;font-weight:700;color:#27316f}
  .certs{white-space:pre-wrap;color:#374151}
  /* Sidebar */
  .side .row{display:flex;align-items:center;gap:8px;margin:8px 0;color:#374151}
  .side .row strong{font-size:14px}
  .side .pill{display:inline-block;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px;font-weight:700;font-size:12px;color:#374151}
  /* Footer */
  footer{color:#64748b;font-size:13px;text-align:center;padding:24px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} .profile-row{flex-direction:column;align-items:start} }
  @media print{
    header,.nav,.actions{display:none!important}
    .banner{height:100px}
    body{background:#fff}
  }
</style>
</head>
<body>
<header>
  <div class="topbar">
    <a class="brand" href="front.html" title="Home">
      <div class="brand-badge">LT</div>
      <div class="brand-text">LinkTradeNetwork</div>
    </a>
    <div class="topbar-actions">
      <a class="btn secondary" href="build-profile.html">Edit profile</a>
      <button class="btn" id="printBtn" type="button">Export PDF</button>
    </div>
  </div>
</header>

<div class="banner"></div>

<main class="wrap">
  <section class="card profile-card">
    <div class="profile-row">
      <div class="avatar" id="avatar">üë§</div>
      <div class="flex-1">
        <div class="headline" id="name">Your Name</div>
        <div class="sub" id="headline">Headline</div>
        <div class="meta">
          <div id="trade">‚Äî</div>
          <div id="location">‚Äî</div>
          <div id="email">‚Äî</div>
          <div id="phone">‚Äî</div>
        </div>
        <div class="chips">
          <span class="chip" id="availability">Employed</span>
        </div>
        <div class="actions">
          <a class="btn" id="contactBtn" href="#" target="_blank" rel="noopener">Message</a>
          <a class="btn secondary" href="build-profile.html">Update details</a>
        </div>
        <nav class="nav" aria-label="Sections">
          <span class="tab active" data-target="#about">About</span>
          <span class="tab" data-target="#experience">Experience</span>
          <span class="tab" data-target="#skills">Skills</span>
          <span class="tab" data-target="#certs">Certifications</span>
        </nav>
      </div>
    </div>
  </section>

  <section class="grid">
    <!-- Main column -->
    <div>
      <div class="card section" id="about">
        <h2>About</h2>
        <div class="about" id="aboutText">No summary yet.</div>
      </div>

      <div class="card section" id="experience" style="display:none">
        <h2>Experience</h2>
        <div id="expList"></div>
      </div>

      <div class="card section" id="skills" style="display:none">
        <h2>Skills</h2>
        <div class="skills" id="skillsList"></div>
      </div>

      <div class="card section" id="certs" style="display:none">
        <h2>Certifications & Licenses</h2>
        <div class="certs" id="certsText">‚Äî</div>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="card section side">
      <h2>Contact & Status</h2>
      <div class="row"><strong>üìß</strong><a id="emailLink" href="#">‚Äî</a></div>
      <div class="row"><strong>üìû</strong><a id="phoneLink" href="#">‚Äî</a></div>
      <div class="row"><strong>üìç</strong><span id="locSide">‚Äî</span></div>
      <div class="row"><strong>üîß</strong><span id="tradeSide">‚Äî</span></div>
      <div class="row"><strong>üü¢</strong><span class="pill" id="availSide">Employed</span></div>
    </aside>
  </section>
</main>

<footer>¬© LinkTradeNetwork ‚Äî Profile</footer>

<script>
  // ===== Utilities =====
  const STORAGE_KEY = 'userProfile:v1';
  const LEGACY_KEY  = 'userProfile';

  const els = {
    avatar: document.getElementById('avatar'),
    name: document.getElementById('name'),
    headline: document.getElementById('headline'),
    trade: document.getElementById('trade'),
    location: document.getElementById('location'),
    email: document.getElementById('email'),
    phone: document.getElementById('phone'),
    availability: document.getElementById('availability'),
    aboutText: document.getElementById('aboutText'),
    expList: document.getElementById('expList'),
    skillsList: document.getElementById('skillsList'),
    certsText: document.getElementById('certsText'),
    emailLink: document.getElementById('emailLink'),
    phoneLink: document.getElementById('phoneLink'),
    locSide: document.getElementById('locSide'),
    tradeSide: document.getElementById('tradeSide'),
    availSide: document.getElementById('availSide'),
    printBtn: document.getElementById('printBtn'),
    contactBtn: document.getElementById('contactBtn'),
  };

  function escapeHTML(s){ return String(s ?? '')
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;').replace(/'/g,'&#39;');
  }
  function telHref(raw){ const d=(raw||'').replace(/\D/g,''); return d?`tel:${d}`:'#'; }
  function mailHref(e){ return e?`mailto:${e}`:'#'; }
  function fmtPhone(raw){ const d=(raw||'').replace(/\D/g,'').slice(-10); return d.length===10?`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`:escapeHTML(raw||''); }
  function availColor(a){
    if(a==='Actively Looking') return {txt:'Actively Looking', bg:'#e6f4ea', color:'#0f5132'};
    if(a==='Open to Offers')   return {txt:'Open to Offers', bg:'#e7f0ff', color:'#0a66c2'};
    if(a==='Not Available')    return {txt:'Not Available', bg:'#fde2e2', color:'#991b1b'};
    return {txt:'Employed', bg:'#fff7e0', color:'#92400e'};
  }

  function readProfile(){
    const raw = localStorage.getItem(STORAGE_KEY) || localStorage.getItem(LEGACY_KEY);
    if(!raw) return null;
    try{ return JSON.parse(raw); }catch{ return null; }
  }

  // ===== Render =====
  function render(){
    const p = readProfile();
    if(!p){
      // If no data, encourage building profile
      document.querySelector('main').innerHTML = `
        <section class="card section" style="margin-top:16px;text-align:center">
          <h2>No Profile Found</h2>
          <p class="sub" style="margin:.5rem 0 1rem">Create your profile to get a LinkedIn-style page.</p>
          <a class="btn" href="build-profile.html">Build Profile</a>
        </section>`;
      return;
    }

    // Avatar
    if(p.photo){
      els.avatar.innerHTML = `<img src="${escapeHTML(p.photo)}" alt="Profile photo" loading="lazy">`;
    }else{
      els.avatar.textContent = 'üë§';
    }

    // Header text
    const fullName = `${p.firstName||''} ${p.lastName||''}`.trim();
    els.name.textContent = fullName || 'Your Name';
    els.headline.textContent = p.headline || '';
    els.trade.textContent = p.trade || '';
    els.location.textContent = p.location || '';
    els.email.innerHTML = p.email ? `<a href="${mailHref(p.email)}">${escapeHTML(p.email)}</a>` : '';
    els.phone.innerHTML = p.phone ? `<a href="${telHref(p.phone)}">${fmtPhone(p.phone)}</a>` : '';

    // Contact button (email priority, else tel if available)
    els.contactBtn.href = p.email ? mailHref(p.email) : (p.phone ? telHref(p.phone) : '#');
    els.contactBtn.textContent = p.email ? 'Message' : (p.phone ? 'Call' : 'Contact');

    // Availability chips
    const ac = availColor(p.availability);
    els.availability.textContent = ac.txt;
    els.availability.style.background = ac.bg;
    els.availability.style.color = ac.color;
    els.availSide.textContent = ac.txt;
    els.availSide.style.background = ac.bg;
    els.availSide.style.color = ac.color;

    // About
    els.aboutText.textContent = p.summary || '‚Äî';

    // Experience
    els.expList.innerHTML = '';
    if(Array.isArray(p.experiences) && p.experiences.some(x=>x?.jobTitle || x?.company)){
      p.experiences.forEach(exp=>{
        if(!(exp?.jobTitle || exp?.company)) return;
        const title = escapeHTML(exp.jobTitle||'Position');
        const company = escapeHTML(exp.company||'Company');
        const dates = [exp.startDate||'', exp.endDate||''].filter(Boolean).join(' ‚Äì ');
        const desc = escapeHTML(exp.description||'');
        const div = document.createElement('div');
        div.className = 'exp-item';
        div.innerHTML = `
          <div class="exp-title">${title}</div>
          <div class="exp-meta">${company}${dates ? ' ¬∑ ' + dates : ''}</div>
          ${desc ? `<div class="exp-desc">${desc}</div>`:''}
        `;
        els.expList.appendChild(div);
      });
    }else{
      els.expList.innerHTML = `<div class="sub">No experience added yet.</div>`;
    }

    // Skills
    els.skillsList.innerHTML = '';
    const skills = typeof p.skills==='string' ? p.skills.split(',').map(s=>s.trim()).filter(Boolean) : [];
    if(skills.length){
      skills.forEach(s=>{
        const span = document.createElement('span');
        span.className='skill';
        span.textContent = s;
        els.skillsList.appendChild(span);
      });
    }else{
      els.skillsList.innerHTML = `<div class="sub">No skills added yet.</div>`;
    }

    // Certs
    els.certsText.textContent = p.certifications || '‚Äî';

    // Sidebar mirrors
    els.emailLink.href = p.email ? mailHref(p.email) : '#';
    els.emailLink.textContent = p.email || '‚Äî';
    els.phoneLink.href = p.phone ? telHref(p.phone) : '#';
    els.phoneLink.textContent = p.phone ? fmtPhone(p.phone) : '‚Äî';
    els.locSide.textContent = p.location || '‚Äî';
    els.tradeSide.textContent = p.trade || '‚Äî';
  }

  // Tabs
  document.querySelectorAll('.tab').forEach(tab=>{
    tab.addEventListener('click', ()=>{
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      const target = tab.getAttribute('data-target');
      document.querySelectorAll('.section').forEach(sec=>{
        if(sec.id && '#'+sec.id === target){ sec.style.display='block'; }
        else if(['about','experience','skills','certs'].includes(sec.id)){ sec.style.display='none'; }
      });
    });
  });

  // Export PDF
  els.printBtn.addEventListener('click', ()=>window.print());

  // Init
  render();
</script>
</body>
</html>
